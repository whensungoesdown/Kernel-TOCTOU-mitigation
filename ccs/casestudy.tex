\subsection{Case studies}
To understand better TOCTOU vulnerabilities, we analyzed in detail several real vulnerabilities of Windows operating system. Although listing these vulnerabilities is not difficult, since for most of them, there is no exploit nor details released previously, understanding, analyzing and reproducing them took us a lot of error. In the following case study, for each case, we first briefly introduce where and how the TOCTOU happens. Then we reproduce the scenario, in other words, write poc (proof of concept) code to trigger the vulnerability. At last we demonstrate and explain how our mitigation works again such vulnerability in detail.