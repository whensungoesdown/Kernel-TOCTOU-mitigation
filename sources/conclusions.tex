\section{Conclusion}
\label{sec:conclusion}

In this paper, we creatively use a hardware feature SMTP of Intel CPU to solve a recently popular and serious vulnerability kernel TOCTOU. To the best of our knowledge, our mitigation is the only run-time protection for this type of vulnerability. We implemented and tested on Windows XP and Windows 7 platforms, it can effectively protect known vulnerabilities. Also, under normal operating conditions, we evaluate it with non-trivial applications and the performance overhead is modest.
