%! TEX root = 'main.tex'
\section{Abstract}
%The key novelty of our work is that it uses SMAP facilities already supported by mainstream Intel CPU to achieve negligible runtime overhead when monitoring kernel to user space accessing activities. Also we use a hypervisor layer to establish a process based fine-grain control of system wide hardware feature, in this case, SMAP, in order to reduce unnecessary performance overhead that waste on protection needless scenarios.

Time-of-check-to-time-of-use (TOCTOU) attacks (also known as race condition) have gained popularity in recent years. In this paper, we address a branch of this issue that exists in the operating system kernel. We have detailed the causes of this vulnerability with real world cases. By utilizing an existing hardware feather on Intel CPU called Supervisor Mode Access Prevention (SMAP),  we present the first run-time approach that mitigation kernel space TOCTOU vulnerability. Detailed technical challenge such as user thread share writing the same memory page as the kernel is also discussed and a novel solution is given. We also evaluate it with non-trivial applications and the performance overhead is modest (below 5\%).  

